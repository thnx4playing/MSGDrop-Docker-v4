var W=window.WebSocket,L=[];window.__wsLog=L;window.__wsCount=0;window.WebSocket=function(u,p){var s=p?new W(u,p):new W(u);console.log("[SPY] connect:",u);L.push({t:Date.now(),dir:"INFO",data:"Connect "+u});var seen={};s.addEventListener("message",function(e){window.__wsCount++;var d=typeof e.data==="string"?e.data:"(bin)";var key="";try{var j=JSON.parse(d);key=j.channel||j.type||j.event||j.action||j.msg||""}catch(x){key=d.substring(0,40)}if(seen[key]&&seen[key]>3){if(seen[key]===4)L.push({t:Date.now(),dir:"RECV",data:"[REPEATED] "+key+" (suppressing further)"});seen[key]++;return}seen[key]=(seen[key]||0)+1;if(L.length<2000){console.log("[SPY] recv #"+window.__wsCount+":",d.substring(0,200));L.push({t:Date.now(),dir:"RECV",data:d})}});var _s=s.send.bind(s);s.send=function(d){var x=typeof d==="string"?d:"(bin)";console.log("[SPY] sent:",x.substring(0,200));if(L.length<2000)L.push({t:Date.now(),dir:"SENT",data:x});return _s(d)};s.addEventListener("close",function(e){L.push({t:Date.now(),dir:"INFO",data:"Close "+e.code})});return s};window.WebSocket.prototype=W.prototype;console.log("[SPY] Ready! Navigate to Party via site links.");